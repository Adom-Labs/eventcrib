"use strict";exports.id=178,exports.ids=[178],exports.modules={50178:(e,s,t)=>{t.r(s),t.d(s,{GET:()=>g,POST:()=>g,authOptions:()=>o});var r=t(93810),a=t(45955),n=t(16591),i=t(39126);let o={providers:[(0,a.Z)({id:"web3",name:"web3",credentials:{message:{label:"Message",type:"text"},signedMessage:{label:"Signed Message",type:"text"}},async authorize(e,s){if(!e?.signedMessage||!e?.message)return null;try{let t=new i.SiweMessage(JSON.parse(e?.message)),r=await t.verify({signature:e.signedMessage,nonce:await (0,n.getCsrfToken)({req:s})});if(!r.success)throw Error("Invalid Signature");if(r.data.statement!==process.env.NEXT_PUBLIC_SIGNIN_MESSAGE)throw Error("Statement Mismatch");return console.log("Returning"),{id:t.address}}catch(e){return console.log(e),null}}})],session:{strategy:"jwt"},debug:!1,secret:process.env.NEXTAUTH_SECRET,callbacks:{session:async({session:e,token:s})=>(e.user.address=s.sub,e.user.token=s,e)},pages:{signIn:"/login"}},g=(0,r.ZP)(o)}};